{"version":3,"sources":["server/controllers/trip.js"],"names":["moment","require","getHistory","req","res","next","historyObjArray","userID","user","_id","userType","searchObj","USER_TYPE_RIDER","riderId","USER_TYPE_DRIVER","driverId","TripSchema","find","$and","tripStatus","sort","bookingTime","tripErr","tripObj","err","APIError","httpStatus","INTERNAL_SERVER_ERROR","length","forEach","obj","index","then","transformedReturnObj","push","returnObj","success","message","data","send","acceptARide","tripId","body","findOneAsync","tripData","saveAsync","newTripData","status","NotifyRiderSms","catch","User","userObj","pickupDate","pickUpTime","format","passengerName","smsText","passengerIds","passengerList","item","element","fname","slice","console","log","getClaimedRides","currentDate","Date","toISOString","sevenDaysDate","add","findAsync","$gt","$lt"],"mappings":"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","file":"trip.js","sourceRoot":"../../../../.."}